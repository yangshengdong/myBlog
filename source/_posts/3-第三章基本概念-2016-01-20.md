title: 第三章 基本概念
date: 2016-01-20 09:38:23
tags:
- JavaScript
comments: true
categories:
- 《JS高程3-笔记》
---
# 语法
## 区分大小写
ECMAScript 中的一切（变量、函数名和操作符）都区分大小写。
<!--more-->
## 标示符
所谓标识符，就是指变量、函数、属性的名字，或者函数的参数。
规则：
* 第一个字符必须是一个字母、下划线`_`或一个美元符号`$`
* 其他字符可以是字母、下划线、美元符号或数字。标识符中的字母包含扩展的ASCll或Unicode字母字符(如À和Æ);

## 严格模式 `"use strict;"`

[严格模式](http://www.yangshengdonghome.com/2016/01/21/%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/)


## 语句

* 一个语句由一个或多个表达式、关键字或运算符（符号）组成。通常，在一个行上书写一个语句，但可在两个行或多个行上书写一个语句。此外，在同一个行上书写两个或多个语句，用分号分隔。通常，每个新行都开始一个新语句。最好是显式终止您的语句。可使用分号 (;) 做到这一点，分号是 JavaScript 语句的终止字符。
* 由括号 ({}) 包围的一组 JavaScript 语句称为一个块。组织在一个块中的语句通常可以视为一个语句，比如`var a = function (){};`和对象字面量(`a = {};`)，这两个结尾的也需要加分号，其他的大括号情况(for循环、ifelse判断)，可以不加分号。

         abc={}bbc=function(){}//报错 Uncaught SyntaxError: Unexpected identifier
         abc=function(){}bbc=function(){}//报错 Uncaught SyntaxError: Unexpected identifier
         if(a==1){}bbc=function(){}// 正常
         for(var a = 1;a<10;a++){}bbc=function(){}//正常

# 关键字和保留字
按照规则，关键字也是语言保留的，不能用作标识符。

* 关键字：真正意义上的保留字。

    if分支语句：if, else
    switch分支语句：switch, case, default, break
    循环语句：do, while, for, continue
    异常处理语句：try, catch, finally, throw
    获取类型：typeof, instanceof
    布尔值：true, false, null
    函数相关：var, void, function, return
    其他：in, this, with, new, delete

* 保留字：结合java、C++等面向对象语言的思路，将来有可能新加入的关键字。

    基本数据类型：byte, char, boolean, int, short, long, float, double, <span style="color:green;">enum</span>
    继承：<span style="color:red;">implements</span>, <span style="color:green;">extends</span>, <span style="color:green;">super</span>
    类与接口：<span style="color:green;">class</span>, <span style="color:red;">interface</span>
    用来修饰函数的关键字：abstract, native, <span style="color:red;">static</span>, final, <span style="color:green;">const</span>, volatile, synchronized
    导入导出：<span style="color:green;">export</span>, <span style="color:green;">import</span>
    访问权限：<span style="color:red;">private</span>, <span style="color:red;">protected</span>, <span style="color:red;">public</span>
    其他：goto, <span style="color:red;">package</span>, throws, transient, debugger, <span style="color:red;">let</span>,  <span style="color:red;">yield</span>,  <span style="color:red;">arguments</span>,  <span style="color:red;">eval</span>
    <span style="color:#ddd;">注意：红色字体为第5版严格模式下做的限制，<span style="color:red;">arguments</span>,  <span style="color:red;">eval</span>这两个在严格模式下不能做标识符或属性名。</span>
    <span style="color:#ddd;">注意：第5版把在非严格模式下运行时的保留字减少到绿色字体这几个，但是为了最大的兼容性还是都不要使用了吧。</span>

> **顺便整理下javascript语言中提供的有用的常用的变量和函数**
> 
数据类型：Number, Boolean, String, undefined, Object, Array, Function, Date, Math, RegExp, Error
错误类型：EvalError, RangeError, ReferenceError, SyntaxError, TypeError, URIError
编码：decodeURI, decodeURIComponent, encodeURI
转义：escape, unescape
类型转换：parentInt, parentFloat
特殊值及判断：isFinite, isNaN, NaN, Infinity
其他：arguments, eval
<span style="red;">这些都不是ECMAScript的关键字，undefined不是关键字但是null确实关键字。</span>
最后注意：我们常用的函数alert()不属于上面的三类。

# 变量

## 声明变量

1. 使用关键词 var，这个语法可以同时用来声明局部(function内部)和全局变量。
2. 在非严格模式下，无论是在全局范围内还是函数内，使用直接给变量赋值`count = 3`这种语法，会产生一个全部变量count(隐式全局变量)，这种方式不推荐。
3. <span style="color:red;">无法用var声明块级局部变量</span>。

        // A single declaration.
        var count;  
        // Multiple declarations with a single var keyword.
        var count, amount, level;    
        // Variable declaration and initialization in one statement.
        var count = 0, amount = 100;
        count = 3;//无论实在全局范围内还是函数内，使用这种语法直接给变量赋值，会产生一个全部变量
如果未在 var 语句中初始化您的变量，它将自动采用 undefined 值，试图访问一个未初始化的变量会导致一个 ReferenceError 异常被抛出

> 隐式全局变量和明确定义的全局变量间有些小的差异，就是通过delete操作符让变量未定义的能力。
>
* 通过var创建的全局变量（任何函数之外的程序中创建）是不能被删除的。
* 无var创建的隐式全局变量（无视是否在函数中创建）是能被删除的。
> 这表明，在技术上，隐式全局变量并不是真正的全局变量，但它们是全局对象的属性。属性是可以通过delete操作符删除的，而变量是不能的：
>
        // 定义三个全局变量
        var global_var = 1;
        global_novar = 2; // 反面教材
        (function () {
           global_fromfunc = 3; // 反面教材
        }());
>
        // 试图删除
        delete global_var; // false
        delete global_novar; // true
        delete global_fromfunc; // true
>        
        // 测试该删除
        typeof global_var; // "number"
        typeof global_novar; // "undefined"
        typeof global_fromfunc; // "undefined"
---
了解另外两种变量的声明方式：
>
    * let：声明块范围局部变量，可选初始化值。
    * const：声明一个只读命名常量。

## 数据类型

ECMAScript是变量松散类型语言(动态数据类型语言)，即每个变量只是一个占位符，其类型并不固定，可以随时变化，这意味着你定义变量时不必指定变量类型，而且变量类型会在脚本执行需要时自动转换。但是，<span style="red;">数据本身和各种运算是有类型的</span>。
ECMAScript 中有5 种简单数据类型（也称为基本数据类型）：Undefined、Null、Boolean、Number和String。还有1 种复杂数据类型——Object，Object 本质上是由一组无序的名值对组成的。

### undefined类型
undefined类型只有一个值，即特殊的undefined，我们称之为`字面值undefined`，undefined意为`未定义`。

`字面值undefined`是全局Global对象（window）的一个特殊属性，其值是未定义的。但 typeof window.undefined 返回"undefined" 。

我们可以通过下面的例子来验证undefined是否为全局Global对象（window）的属性:

    alert('undefined' in window);//输出：true   
    var anObj = {};   
    alert('undefined' in anObj); //输出：false 
    从中可以看出，undefined是window对象的一个属性，但却不是anObj对象的一个属性。

`字面值undefined`产生的原因有5种：

    * 访问对象不存在的属性或方法
    * 声明了变量但从未赋值
    * 调用函数时，应该提供的参数没有提供，该参数等于undefined。
    * 方法没有返回值，默认返回undefined
    * 访问越界的数组。

    var v1,obj = {};      
      
    console.log(v1); //`字面值undefined`    
    console.log(obj.get); //`字面值undefined`
    
    typeof v1; // "undefined"    
    typeof v2; // 对未声明的变量使用typeof 也会输出 "undefined"。     
    typeof obj.get; // "undefined"
    
    var message1 = undefined;  //显示的设置为undefined
    typeof message1 //"undefined"
    
    function test(){}; 
    console.log(test()); //`字面值undefined`
    
    var arr = []; 
    console.log(arr[8]) //`字面值undefined`
        
<span style="red;">当我们在程序中使用`字面值undefined`时，实际上使用的是window对象的undefined属性，同样，当我们定义一个变量但未赋予其初始值，例如：`var aValue;`这时，JavaScript在预编译时会将其初始值设置为对window.undefined属性的引用，于是，当我们将一个变量或值与undefined比较时，实际上是与window对象的undefined属性比较。这个比较过程中，JavaScript会搜索window对象名叫"undefined"的属性，然后再比较两个操作数的引用指针是否相同。</span>

---
您可以通过将变量与`字面值undefined`进行比较确定变量是否存在，您也可以通过将变量的类型与字符串“undefined”进行比较确定其类型是否为 undefined类型。
以下示例演示了如何确定已声明的变量的 x：
        
    var x;
    
    // This method works.
    if (x == undefined) { //这种方式只能对已经声明的变量使用，对未声明的变量使用会报错。
        document.write("comparing x to undefined <br/>");
    }
    
    // This method doesn't work - you must check for the string "undefined".
    if (typeof(x) == undefined) {//未执行，因为typeof 方法返回的是字符串。
        document.write("comparing the type of x to undefined <br/>");
    }
    // This method does work. 
    if (typeof(x) == "undefined") {
        document.write("comparing the type of x to the string 'undefined'");
    }
    
    // Output: 
    // comparing x to undefined 
    // comparing the type of x to the string 'undefined'
#### 提高访问`字面值undefined`的性能：
由于window对象的属性值是非常多的，在每一次与`字面值undefined`的比较中，搜索window对象的undefined属性都会花费时间。在需要频繁与undefined进行比较的函数中，这可能会是一个性能问题点。因此，在这种情况下，我们可以自行定义一个局部的undefined变量，来加快对undefined的比较速度。例如：

    function anyFunc() {
        var undefined; //自定义局部undefined变量
        if (x == undefined){} //作用域上的引用比较
        while (y != undefined){} //作用域上的引用比较
    };
其中，定义undefined局部变量时，其初始值会是对window.undefined属性值的引用。新定义的局部undefined变量存在与该函数的作用域上。
在随后的比较操作中，JavaScript代码的书写方式没有任何的改变，但比较速度却很快。因为作用域上的变量数量会远远少于window对象的属性，搜索变量的速度会极大提高。
这就是许多前端JS框架为什么常常要自己定义一个局部undefined变量的原因!!!
比如jQuery 源码：

    (function( window, undefined ) {
        /*
        * 
        * code
        * 
        * */
    })( window );

### null类型

null类型也只有一个值：null , 表示一个变量中没有包含有效数据，null表示"没有对象"。`字面值null`在这里意为`空值`、`空对象`的意思，更确切的说，一个被赋值为null的变量没有保存有效的对象等，可以通过给一个变量赋值为null来清空变量中的内容(不删除变量)。

主要用处：

* 作为函数的参数传递，表示该函数的参数不是对象。
* 作为对象原型链的终点。

    Object.getPrototypeOf(Object.prototype) // null

产生null的原因只有一个，即对一个变量显式的赋值为null 。



    var p = null;
    console.log(p); //null
    typeof p; // "object"
    typeof null; // "object"
另外，需要注意的是，typeof null 应该返回"null"，但实际上返回的是"object"，这是一个历史遗留问题，并没有其他原因，不要想太多，曾经有提案 typeof null === 'null'但提案被拒绝。
> 《javascript高级程序设计3》是这么解释的从逻辑角度来看，null 值表示一个空对象指针，而这也正是使用typeof 操作符检测null 值时会返回"object"的原因。

    判断null值，这个时候就不能用typeOf了，直接用if(xxx === null){}
    console.log(typeof null) //"Object"
    console.log(null instanceof Object) // false
    var a = null,b;
    console.log(a === null) //true
    console.log(b === null) //false 因为 undefined !== null  三个等号为false
    console.log(b == null) // true 两个等号为true
    
>undefined == null //true [为什么相等？](https://www.w3.org/html/ig/zh/wiki/ES5/expressions#.E7.AD.89.E5.80.BC.E8.BF.90.E7.AE.97.E7.AC.A6)

### Boolean类型

boolean类型只有两个字面值：`true`和`false` 。 但在Javascript中，所有类型的值都可以转化为与boolean等价的值。要将一个值转换为其对应的Boolean值，可以调用类型转换函数Boolean()。其中转换结果为false的值有(false, "", +0, -0, NaN, null, undefined)，其他值(包括空对象、空数组)均将转换为true。

    typeof true; // "boolean"
    
    typeof false; // "boolean"
    
    Boolean(new Object()); //true
    
    Boolean(undefined); //false
    
    Boolean(null); //false
    
    Boolean(''); //false
    
    Boolean(0); //false
    
    Boolean(100); // true
    
    Boolean([]) // true
     
    Boolean({}) // true
    
if判断语句中自动调用Boolean()。

    if (x = y + z){} //将值 y + z 赋给变量 x，然后检查整个表达式的结果（x 的值）是否为 0。

### Number类型

在 JavaScript 中使用IEEE754格式来表示整数和浮点数值，数字可以是两种类型中的任意一种（在内部，JavaScript 作为浮点值表示所有数字），还有一种特殊的数值，即NaN（非数值 Not a Number）。

JavaScript 使用数字表示形式的 8 字节 IEEE 754 浮点标准来表示数字。

    精确地描述，Number类型拥有 18437736874454810627（即，264-253+3）个值，表示为 IEEE-754 格式 64 位双精度数值（IEEE 二进制浮点数算术中描述了它），除了 IEEE 标准中的 9007199254740990（即，253-2）个明显的“非数字”值；在 ECMAScript 中，它们被表示为一个单独的特殊值：NaN。（请注意，NaN 值由程序表达式 NaN 产生，并假设执行程序不能调整定义的全局变量 NaN。） 在某些实现中，外部代码也许有能力探测出众多非数字值之间的不同，但此类行为依赖于具体实现；对于 ECMAScript 代码而言，NaN 值相互之间无法区别。还有另外两个特殊值，称为正无穷和负无穷。为简洁起见，在说明目的时，用符号 +∞ 和 -∞ 分别代表它们。（请注意，两个无限数值由程序表达式 +Infinity（简作 Infinity） 和 -Infinity 产生，并假设执行程序不能调整定义的全局变量 Infinity。）另外 18437736874454810624（即，264-253） 个值被称为有限数值。
    NaN 用于处理计算中出现的错误情况，比如 0.0 除以 0.0 或者求负数的平方根。由上面的表中可以看出，对于单精度浮点数，NaN 表示为指数为 emax + 1 = 128（指数域全为 1），且尾数域不等于零的浮点数。IEEE 标准没有要求具体的尾数域，所以 <span style="red;">NaN 实际上不是一个，而是一族</span>。
    
> 对于这个如果有兴趣细扣就[点这里](http://www.cnblogs.com/kingwolfofsky/archive/2011/07/21/2112299.html)，[还有这里](https://www.w3.org/html/ig/zh/wiki/ES5/types#Number_.E7.B1.BB.E5.9E.8B)

#### 整数

整数可以被表示成十进制（基数为10）、十六进制（基数为16）以及八进制（基数为8）。

* 十进制整数字组成的数字序列，不带前导0（零）。
* 通过在八进制整数前面加前导“0”（零）来表示八进制整数。八进制整数只包含 0 到 7 的数字。<span style="red;">具有前导“0”并包含数字“8”和/或“9”的数字将被解释为十进制数字</span>。八进制整数只能包括数字0-7。
* 通过在整数前面加前导“0x”（零和 x|X）来表示十六进制（“hex”）整数。字母 A 到 F 以单个数字的形式表示以 10 为基数的 10 到 15。字母 A 到 F 用于以单个数字的形式表示以 10 为基数的 10 到 15。即，0xF 相当于 15，0x10 相当于 16。

在进行算术计算时，所有以八进制和十六进制表示的数值最终都将被转换成十进制数值，还有严格模式下禁止使用八进制。

    0, 117 and -345 (decimal, base 10)
    015, 0001 and -077 (octal, base 8) 
    0x1123, 0x00111 and -0xF1A7 (hexadecimal, "hex" or base 16)

<span style="#555;">IEBUG：从 Internet Explorer 9 标准模式、Internet Explorer 10 标准模式、Internet Explorer 11 标准模式和 Windows 应用商店应用 开始，parseInt 函数不将前缀为“0”的字符串视为八进制。但在不使用 parseInt 函数时，前缀为“0”的字符串仍可被解释为八进制。</span>

#### 浮点值

* 一个十进制整数，它可以带符号（即前面的“+”或“ - ”号），
* 一个小数点（“.”），
* 一个小数部分（由一串十进制数表示），
* 一个指数部分
指数部分是以“e”或“E”开头后面跟着一个整数，可以有正负号（即前面写“+”或“-”）。一个浮点数字面值必须至少有一位数字，后接小数点或者“e”（大写“E”也可）组成。一些浮点数字面值的例子，如3.1415，-3.1E13，.1e12以及2E-12。
简言之，其语法是：

        [digits][.digits][(E|e)[(+|-)]digits]
        //实例:
        3.14
        2345.789
        .3333333333333333333 // 0 可以省略
数轴：
{% asset_img number.png %}